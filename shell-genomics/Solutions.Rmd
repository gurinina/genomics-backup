---
title: "Solutions"
output: html_document
date: "2022-10-21"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## 02-the-filesystem

## Exercise

First navigate to the `shell_data` directory. There is a hidden directory within this directory. Explore the options for `ls` to 
find out how to see hidden directories. List the contents of the directory and 
identify the name of the text file in that directory.

Hint: hidden files and folders in Unix start with `.`, for example `.my_hidden_directory`

## Solution

First use the `man` command to look at the options for `ls`. 

```{bash}

man ls

```

The `-a` option is short for `all` and says that it causes `ls` to "not ignore
entries starting with ." This is the option we want. 


```{bash}

cd ~/shell_data
ls -a

```

The name of the hidden directory is `.hidden`. We can navigate to that directory
using `cd`. 


```{bash}

cd ~/shell_data
cd .hidden

```

And then list the contents of the directory using `ls`. 


```{bash}

cd ~/shell_data/.hidden
ls

```


The name of the text file is `youfoundit.txt`.


## Navigating practice

## Exercise

Navigate to your home directory. From there, list the contents of the `untrimmed_fastq` 
directory. 

## Solution


```{bash}

cd ~
ls shell_data/untrimmed_fastq

```


## Relative path resolution

## Exercise

Using the filesystem diagram below, if `pwd` displays `/Users/thing`,
what will `ls ../backup` display?

1.  `../backup: No such file or directory`
2.  `2012-12-01 2013-01-08 2013-01-27`
3.  `2012-12-01/ 2013-01-08/ 2013-01-27/`
4.  `original pnas_final pnas_sub`

![File System for Challenge Questions](fig/filesystem-challenge.svg)

## Solution
 
 1. No: there *is* a directory `backup` in `/Users`.
 2. No: this is the content of `Users/thing/backup`,
  but with `..` we asked for one level further up.
 3. No: see previous explanation.
   Also, we did not specify `-F` to display `/` at the end of the directory names.
 4. Yes: `../backup` refers to `/Users/backup`.

## 03-working-with-files

## Exercise

Do each of the following tasks from your current directory using a single
`ls` command for each:

1.  List all of the files in `/usr/bin` that start with the letter 'c'.
2.  List all of the files in `/usr/bin` that contain the letter 'a'. 
3.  List all of the files in `/usr/bin` that end with the letter 'o'.

Bonus: List all of the files in `/usr/bin` that contain the letter 'a' or the
letter 'c'.

Hint: The bonus question requires a Unix wildcard that we haven't talked about
yet. Try searching the internet for information about Unix wildcards to find
what you need to solve the bonus problem.

## Solution
1. `ls /usr/bin/c*`
2. `ls /usr/bin/*a*`
3. `ls /usr/bin/*o`  
Bonus: `ls /usr/bin/*[ac]*`

## Exercise
`echo` is a built-in shell command that writes its arguments, like a line of text to standard output. The arguments passed to `echo` are displayed as a line of text. The `echo` command can also be used with pattern matching characters, such as wildcard characters. Here we will use the `echo` command to see how the wildcard character is interpreted by the shell.

```{bash}

cd ~/shell_data/untrimmed_fastq
echo *.fastq

```

The `*` is expanded to include any file that ends with `.fastq`. We can see that the output of
`echo *.fastq` is the same as that of `ls *.fastq`.

What would the output look like if the wildcard could *not* be matched? Compare the outputs of
`echo *.missing` and `ls *.missing`.

## Solution



```{bash, eval=FALSE, engine="sh"}

echo *.missing

```



```{bash, eval=FALSE, engine="sh"}

ls *.missing

```

## Exercise

Find the line number in your history for the command that listed all the .sh
files in `/usr/bin`. Rerun that command.

## Solution

First type `history`. Then use `!` followed by the line number to rerun that command.

To find commands in your history, you can also use grep:

```{bash}

history | grep *.sh

```

## Exercise

What are the next three nucleotides (characters) after the first instance of the sequence quoted above?

## Solution
`CAC`


## Exercise

1.  What is the last line of the `~/shell_data/untrimmed_fastq/SRR097977.fastq ` file?
2.  From your home directory, and without changing directories,
use one short command to print the contents of all of the files in
the `~/shell_data/untrimmed_fastq` directory into one file.

## Solution
1. The last line of the file is `C:CCC::CCCCCCCC<8?6A:C28C<608'&&&,'$`.
2. cat ~/shell_data/untrimmed_fastq/* > fastq.txt

## Exercise

Starting in the `shell_data/untrimmed_fastq/` directory, do the following:
1. Make sure that you have deleted your backup directory and all files it contains.  
2. Create a backup of each of your FASTQ files using `cp`. (Note: You'll need to do this individually for each of the  two FASTQ files. We haven't learned yet how to do this with a wildcard.)  
3. Use a wildcard to move all of your backup files to a new backup directory.   
4. Change the permissions on all of your backup files to be write-protected.  

## Solution

1. `rm -r backup`  
2. `cp SRR098026.fastq SRR098026-backup.fastq ` and `cp SRR097977.fastq SRR097977-backup.fastq`  
3. `mkdir backup` and `mv *-backup.fastq backup`
4. `chmod -w backup/*-backup.fastq`   

```{bash}
rm -r backup
cp SRR098026.fastq SRR098026-backup.fastq
cp SRR097977.fastq SRR097977-backup.fastq
mkdir backup
mv *-backup.fastq backup
chmod -w backup/*-backup.fastq`
```

It's always a good idea to check your work with `ls -l backup`. You should see something like: 

-r--r--r-- 1 dcuser dcuser 47552 Nov 15 23:06 SRR097977-backup.fastq
-r--r--r-- 1 dcuser dcuser 43332 Nov 15 23:06 SRR098026-backup.fastq 

## 04-redirection

## Exercise

1. Search for the sequence `GNATNACCACTTCC` in the `SRR098026.fastq` file.
Have your search return all matching lines and the name (or identifier) for each sequence
that contains a match.

2. Search for the sequence `AAGTT` in both FASTQ files.
Have your search return all matching lines and the name (or identifier) for each sequence
that contains a match.

## Solution  

1. `grep -B1 GNATNACCACTTCC SRR098026.fastq` 

2. `grep -B1 AAGTT *.fastq`

```{bash}

cd ~/shell_data/untrimmed_fastq/

grep -B1 GNATNACCACTTCC SRR098026.fastq



```


```{bash}

cd ~/shell_data/untrimmed_fastq/

grep -B1 AAGTT *.fastq


```
## Exercise

How many sequences are there in `SRR098026.fastq`? Remember that every sequence is formed by four lines.

## Solution

```{bash}

cd ~/shell_data/untrimmed_fastq/
wc -l SRR098026.fastq

```

Now you can divide this number by four to get the number of sequences in your fastq file

996/4

## Exercise

How many sequences in `SRR098026.fastq` contain at least 3 consecutive Ns?

## Solution

```{bash}

cd ~/shell_data/untrimmed_fastq/
grep NNN SRR098026.fastq > bad_reads.txt
wc -l bad_reads.txt

```


## Exercise

Print the file prefix of all of the `.txt` files in our current directory.

## Solution


```{bash}

cd ~/shell_data/untrimmed_fastq/

for filename in *.txt
do
name=$(basename ${filename} .txt)
echo ${name}
done

```


## Exercise

Remove `_2022` from all of the `.txt` files. 

## Solution
 
```{bash}

cd ~/shell_data/untrimmed_fastq/

for filename in *_2022.txt
do
name=$(basename ${filename} _2019.txt)
mv ${filename} ${name}.txt
done
```

## 05-writing-scripts

## Exercise

Open `README.txt` and add the date to the top of the file and save the file. 

## Solution

Use `nano README.txt` to open the file.  
Add today's date and then use <kbdCtrl</kbd-<kbdX</kbdfollowed by `y` and <kbdEnter</kbdto 

## Exercise

We want the script to tell us when it's done.  
1. Open `bad-reads-script.sh` and add the line `echo "Script finished!"` after the `grep` command and save the file.  
2. Run the updated script.

## Solution

  bash bad-reads-script.sh
  Script finished!

## 06-organization

## Exercise  

Use the `mkdir` command to make the following directories: 

- `dc_workshop`
- `dc_workshop/docs`
- `dc_workshop/data`
- `dc_workshop/results`

```{bash, eval=FALSE, engine="sh"}
cd ~/dc_workshop/data/untrimmed_fastq`
nano README.txt
```

## Solution

You should make these directories:

```{bash, eval=FALSE, engine="sh"}

cd ~

mkdir dc_workshop
mkdir dc_workshop/docs
mkdir dc_workshop/data
mkdir dc_workshop/results

```



